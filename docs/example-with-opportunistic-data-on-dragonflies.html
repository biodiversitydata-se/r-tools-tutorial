<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Example with opportunistic data on Dragonflies | Using R tools for analysis  of primary biodiversity data provided by SBDI</title>
  <meta name="description" content="R tools for biodiversity data" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Example with opportunistic data on Dragonflies | Using R tools for analysis  of primary biodiversity data provided by SBDI" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="R tools for biodiversity data" />
  <meta name="github-repo" content="biodiversitydata-se/r-tools-tutorial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Example with opportunistic data on Dragonflies | Using R tools for analysis  of primary biodiversity data provided by SBDI" />
  
  <meta name="twitter:description" content="R tools for biodiversity data" />
  

<meta name="author" content="Debora Arlt and Alejandro Ruete  for the Swedish Biodiversity Data Infrastructure" />


<meta name="date" content="2021-05-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="example-with-fish-data-from-sers.html"/>

<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"> <strong>R tools for biodiversity data</strong></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-and-mirroreum"><i class="fa fa-check"></i>R and Mirroreum</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sbdi4r---r-package-to-search-an-access-data"><i class="fa fa-check"></i>SBDI4R - R package to search an access data</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#customizing-sbdi4r"><i class="fa fa-check"></i>Customizing SBDI4R</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caching"><i class="fa fa-check"></i>Caching</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#e-mail-address"><i class="fa fa-check"></i>E-mail address</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#setting-the-download-reason"><i class="fa fa-check"></i>Setting the download reason</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-options"><i class="fa fa-check"></i>Other options</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-packages-needed"><i class="fa fa-check"></i>Other packages needed</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#your-collaboration-is-appreciated"><i class="fa fa-check"></i>Your collaboration is appreciated</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="example-with-fish-data-from-sers.html"><a href="example-with-fish-data-from-sers.html"><i class="fa fa-check"></i><b>1</b> Example with fish data from SERS</a>
<ul>
<li class="chapter" data-level="1.1" data-path="example-with-fish-data-from-sers.html"><a href="example-with-fish-data-from-sers.html#plotting-data-on-a-map"><i class="fa fa-check"></i><b>1.1</b> Plotting data on a map</a></li>
<li class="chapter" data-level="1.2" data-path="example-with-fish-data-from-sers.html"><a href="example-with-fish-data-from-sers.html#temporal-summary"><i class="fa fa-check"></i><b>1.2</b> Temporal summary</a></li>
<li class="chapter" data-level="1.3" data-path="example-with-fish-data-from-sers.html"><a href="example-with-fish-data-from-sers.html#species-summary"><i class="fa fa-check"></i><b>1.3</b> Species summary</a></li>
<li class="chapter" data-level="1.4" data-path="example-with-fish-data-from-sers.html"><a href="example-with-fish-data-from-sers.html#spatial-biodiversity-analysis"><i class="fa fa-check"></i><b>1.4</b> Spatial biodiversity analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-with-opportunistic-data-on-dragonflies.html"><a href="example-with-opportunistic-data-on-dragonflies.html"><i class="fa fa-check"></i><b>2</b> Example with opportunistic data on Dragonflies</a>
<ul>
<li class="chapter" data-level="2.1" data-path="example-with-opportunistic-data-on-dragonflies.html"><a href="example-with-opportunistic-data-on-dragonflies.html#name-searching"><i class="fa fa-check"></i><b>2.1</b> Name searching</a></li>
<li class="chapter" data-level="2.2" data-path="example-with-opportunistic-data-on-dragonflies.html"><a href="example-with-opportunistic-data-on-dragonflies.html#get-the-observations-filter-the-search-get-quality-assertions-plotting-data-on-a-map-and-save-data"><i class="fa fa-check"></i><b>2.2</b> Get the observations, filter the search, get quality assertions, plotting data on a map and save data</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using R tools for analysis <br>of primary biodiversity data provided by SBDI</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example-with-opportunistic-data-on-dragonflies" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Example with opportunistic data on Dragonflies</h1>
<p>In this example we are interested in exploring opportunistically collected data
from the Swedish citizen science observation data portal - Artportalen.</p>
<div id="name-searching" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Name searching</h2>
<p>To begin, we want be sure there is an unequivocal way to find the species within
the order Odonata and nothing else, so let’s search for it:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="example-with-opportunistic-data-on-dragonflies.html#cb1-1" aria-hidden="true" tabindex="-1"></a>sx <span class="ot">&lt;-</span> <span class="fu">search_fulltext</span>(<span class="st">&quot;odonata&quot;</span>)</span>
<span id="cb1-2"><a href="example-with-opportunistic-data-on-dragonflies.html#cb1-2" aria-hidden="true" tabindex="-1"></a>sx<span class="sc">$</span>data[, <span class="fu">c</span>(<span class="st">&quot;guid&quot;</span>, <span class="st">&quot;scientificName&quot;</span>, <span class="st">&quot;rank&quot;</span>, <span class="st">&quot;occurrenceCount&quot;</span>)]</span></code></pre></div>
<pre><code>##       guid                          scientificName    rank occurrenceCount
## 1  9829523  Odonata associated gemycircularvirus 1 species               0
## 2 10072832  Odonata associated gemycircularvirus 2 species               0
## 3  8062407 Bdellodes odonata Wallace &amp; Mahon, 1976 species               0
## 4      789                                 Odonata   order          207680
## 5  7367071    Ramalina fastigiata var. odonata Hue variety               0</code></pre>
<p>We quickly see there that other taxonomic definitions appear too, but there is only one order.
Let’s refine the search. To know which search fields we can use to filter the search
we use the function <code>sbdi_fields(fields_type = "general")</code>.
The search field we are looking for is “order_s.”</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="example-with-opportunistic-data-on-dragonflies.html#cb3-1" aria-hidden="true" tabindex="-1"></a>sx <span class="ot">&lt;-</span> <span class="fu">search_fulltext</span>(<span class="at">fq=</span><span class="st">&quot;order_s:Odonata&quot;</span>, <span class="at">page_size =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] &quot;https://species.biodiversitydata.se/ws/search.json?fq=order_s%3AOdonata&amp;fq=idxtype%3ATAXON&amp;pageSize=10&quot;</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="example-with-opportunistic-data-on-dragonflies.html#cb5-1" aria-hidden="true" tabindex="-1"></a>sx<span class="sc">$</span>data[, <span class="fu">c</span>(<span class="st">&quot;scientificName&quot;</span>, <span class="st">&quot;rank&quot;</span>, <span class="st">&quot;occurrenceCount&quot;</span>)]</span></code></pre></div>
<pre><code>##                                scientificName  rank occurrenceCount
## 1                 Gomphomacromia Brauer, 1864 genus               1
## 2                Austropetalia Tillyard, 1916 genus               0
## 3                  Sogjutella Pritykina, 1980 genus               0
## 4                     Neuragrion Karsch, 1891 genus               0
## 5               Xamenophlebia Pritykina, 1981 genus               0
## 6                Lauromacromia Geijskes, 1970 genus               0
## 7                      Sympetrum Newman, 1833 genus           27050
## 8  Corduliochlora Marinov &amp; Seidenbusch, 2007 genus               0
## 9              Torrenticnemis Lieftinck, 1949 genus               0
## 10                  Cyanallagma Kennedy, 1920 genus               0</code></pre>
<p>Now we can download the taxonomic data (note that the search is case-sensitive):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="example-with-opportunistic-data-on-dragonflies.html#cb7-1" aria-hidden="true" tabindex="-1"></a>tx <span class="ot">&lt;-</span> <span class="fu">taxinfo_download</span>(<span class="st">&quot;order_s:Odonata&quot;</span>, </span>
<span id="cb7-2"><a href="example-with-opportunistic-data-on-dragonflies.html#cb7-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fields =</span> <span class="fu">c</span>(<span class="st">&quot;guid&quot;</span>, <span class="st">&quot;order_s&quot;</span>,<span class="st">&quot;genus_s&quot;</span>, <span class="st">&quot;specificEpithet_s&quot;</span>, </span>
<span id="cb7-3"><a href="example-with-opportunistic-data-on-dragonflies.html#cb7-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;scientificName&quot;</span>,  <span class="st">&quot;canonicalName_s&quot;</span>, <span class="st">&quot;rank&quot;</span>), </span>
<span id="cb7-4"><a href="example-with-opportunistic-data-on-dragonflies.html#cb7-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-5"><a href="example-with-opportunistic-data-on-dragonflies.html#cb7-5" aria-hidden="true" tabindex="-1"></a>tx <span class="ot">&lt;-</span> tx[tx<span class="sc">$</span>rank <span class="sc">==</span> <span class="st">&quot;species&quot;</span> <span class="sc">&amp;</span> tx<span class="sc">$</span>genusS <span class="sc">!=</span> <span class="st">&quot;&quot;</span>,] <span class="do">## restrict to species and not hybrids</span></span></code></pre></div>
<p>Then you can save <code>tx</code> as the complete species list for later use.</p>
</div>
<div id="get-the-observations-filter-the-search-get-quality-assertions-plotting-data-on-a-map-and-save-data" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Get the observations, filter the search, get quality assertions, plotting data on a map and save data</h2>
<p>As usual we start by searching for the data resource we are interested in using
the function <code>pick_filter()</code>. This is an interactive query guiding you through
the many resources available to filtering your query (data resources, spatial
layers, and curated species lists).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="example-with-opportunistic-data-on-dragonflies.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># follow the instructions </span></span>
<span id="cb8-2"><a href="example-with-opportunistic-data-on-dragonflies.html#cb8-2" aria-hidden="true" tabindex="-1"></a>fq_str <span class="ot">&lt;-</span> <span class="fu">pick_filter</span>(<span class="st">&quot;resource&quot;</span>) </span></code></pre></div>
<p>Follow the instruction. Your choices here would have been “in3” –&gt; “dr5.”
Your variable <code>fq_str</code> will now contain a string “data_resource_uid:dr5.”</p>
<p>We only need data from 2000 to 2010</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="example-with-opportunistic-data-on-dragonflies.html#cb9-1" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb9-2"><a href="example-with-opportunistic-data-on-dragonflies.html#cb9-2" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="dv">2010</span></span>
<span id="cb9-3"><a href="example-with-opportunistic-data-on-dragonflies.html#cb9-3" aria-hidden="true" tabindex="-1"></a>fq_str <span class="ot">&lt;-</span> <span class="fu">c</span>(fq_str, <span class="fu">paste0</span>(<span class="st">&quot;year:[&quot;</span>, y1, <span class="st">&quot; TO &quot;</span>, y2,<span class="st">&quot;]&quot;</span>))</span>
<span id="cb9-4"><a href="example-with-opportunistic-data-on-dragonflies.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Note the square brackets are hard limits</span></span></code></pre></div>
<p>Select data – get records for Southern Sweden (<a href="https://en.wikipedia.org/wiki/G%C3%B6taland">Götaland</a>).</p>
<p>Vector spatial layers (eg. polygons) can be imported in a number of different ways.
SBDI APIs take as search input polygons in the s.k. WKT <a href="https://www.geoapi.org/3.0/javadoc/org/opengis/referencing/doc-files/WKT.html">Well Known Text</a>
format. So the first step is to load a vector layer and transform it into a WKT string.
You could instead use the data we kindly provided in the SBDI4R package <code>data("swe")</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="example-with-opportunistic-data-on-dragonflies.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;swe&quot;</span>)</span>
<span id="cb10-2"><a href="example-with-opportunistic-data-on-dragonflies.html#cb10-2" aria-hidden="true" tabindex="-1"></a>wGotaland <span class="ot">&lt;-</span> swe<span class="sc">$</span>Counties<span class="sc">$</span>LnNamn <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Blekinge&quot;</span>, <span class="st">&quot;Gotlands&quot;</span>, <span class="st">&quot;Hallands&quot;</span>, <span class="st">&quot;Jönköpings&quot;</span>, <span class="st">&quot;Kalmar&quot;</span>, <span class="st">&quot;Kronobergs&quot;</span>, <span class="st">&quot;Östergötlands&quot;</span>, <span class="st">&quot;Skåne&quot;</span>, <span class="st">&quot;Västra Götalands&quot;</span>)</span>
<span id="cb10-3"><a href="example-with-opportunistic-data-on-dragonflies.html#cb10-3" aria-hidden="true" tabindex="-1"></a>shape <span class="ot">&lt;-</span> swe<span class="sc">$</span>Counties[wGotaland,]</span></code></pre></div>
<p>We could create the WKT string using the <code>rgeos</code> library:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="example-with-opportunistic-data-on-dragonflies.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgeos)</span>
<span id="cb11-2"><a href="example-with-opportunistic-data-on-dragonflies.html#cb11-2" aria-hidden="true" tabindex="-1"></a>wkt <span class="ot">&lt;-</span> <span class="fu">writeWKT</span>(shape)</span></code></pre></div>
<p>Unfortunately, in this instance this gives a WKT string that is too long and won’t
be accepted by the web service. Also, the shapefile we just got is projected in
the coordinate system SWEREF99 TM, and the web service only accepts coordinates in
a geodesic coordinate system WGS84. Instead, let’s construct the WKT string directly,
which gives us a little more control over its format:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-1" aria-hidden="true" tabindex="-1"></a>shape <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">as_Spatial</span>(</span>
<span id="cb12-2"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-2" aria-hidden="true" tabindex="-1"></a>                sf<span class="sc">::</span><span class="fu">st_transform</span>(</span>
<span id="cb12-3"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-3" aria-hidden="true" tabindex="-1"></a>                  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(shape), </span>
<span id="cb12-4"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">crs =</span> sf<span class="sc">::</span><span class="fu">st_crs</span>(<span class="dv">4326</span>)<span class="sc">$</span>wkt) )</span>
<span id="cb12-5"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the polygon coordinates</span></span>
<span id="cb12-7"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-7" aria-hidden="true" tabindex="-1"></a>lonlat <span class="ot">&lt;-</span> shape<span class="sc">@</span>polygons[[<span class="dv">1</span>]]<span class="sc">@</span>Polygons[[<span class="dv">1</span>]]<span class="sc">@</span>coords </span>
<span id="cb12-8"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create a convex hull of the polygon to reduce the length of the WKT string</span></span>
<span id="cb12-10"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-10" aria-hidden="true" tabindex="-1"></a>chull_temp <span class="ot">&lt;-</span> <span class="fu">chull</span>(lonlat)</span>
<span id="cb12-11"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-11" aria-hidden="true" tabindex="-1"></a>lonlat <span class="ot">&lt;-</span> lonlat[<span class="fu">c</span>(chull_temp, chull_temp[<span class="dv">1</span>]), ]</span>
<span id="cb12-12"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># create WKT string</span></span>
<span id="cb12-14"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># first join each lon-lat coordinate pair</span></span>
<span id="cb12-15"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-15" aria-hidden="true" tabindex="-1"></a>wkt_temp <span class="ot">&lt;-</span> <span class="fu">apply</span>(lonlat, <span class="dv">1</span>, <span class="cf">function</span>(z) <span class="fu">paste</span>(<span class="fu">round</span>(z,<span class="dv">4</span>), <span class="at">collapse=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb12-16"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co"># now build the WKT string</span></span>
<span id="cb12-17"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-17" aria-hidden="true" tabindex="-1"></a>wkt <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;MULTIPOLYGON(((&quot;</span>, <span class="fu">paste</span>(wkt_temp, <span class="at">collapse=</span><span class="st">&quot;,&quot;</span>), <span class="st">&quot;)))&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb12-18"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: as of today, the SBDI APIs will only work properly if the polygon is </span></span>
<span id="cb12-19"><a href="example-with-opportunistic-data-on-dragonflies.html#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># submitted as a MULTIPOLYGON</span></span></code></pre></div>
<p>wkt=wkt,</p>
<p>but before we can use the observation records we need to know how the observation effort has varied over time and in space. For this we define field visits i.e. occasions at which an observer has sampled observations – if we have information on observer id, location id and date we can aggregate data into “field visits.” We do this using BIRDS, and 25km grid:</p>
<p>How has observation effort (frequency of visits) varied over time and space? – 1) show maps as in Example 7 (all years, year 2000, 2002, 2004, 2006, 2008, 2010), 2 make also a time line plot with no. visits against years, no. of gridcells with visits against years.</p>
<p>We can now look at some particular species and ask whether this has changed in occurrence over time:
Plot no. records of species x and no. visits all species over years (we simply explore by comparing records for a species with no visits, can assume that species has increased of stronger positive trend than for no. visits)</p>
<p>Plot no. gridcells with visits for species x and no. gridcells with visits for all species over years (we simply explore by comparing records for a species with no visits, can assume that species has increased of stronger positive trend than for no. visits)
(species x: Tvåfläckad trollslända Epitheca bimaculata)</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="example-with-fish-data-from-sers.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["r-tools-tutorial.pdf"],
"toc": {
"collapse": "subsection"
},
"collapse": "chapter"
});
});
</script>

</body>

</html>
